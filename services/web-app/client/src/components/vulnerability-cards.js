import React from 'react';
import Card from 'react-bootstrap/Card';
import CodeBlockSnippet from './display-code-snippet';
import 'bootstrap/dist/css/bootstrap.min.css';
import './vuln-cards.css'

function VulnerabilityCards({ vulnerabilities, language }) { // Expect an array of vulnerabilities

  if (vulnerabilities.length === 0) {
    // Display a message if there are no vulnerabilities
    return (
      <div className="success-message">
        <i className="success-icon fas fa-check-circle"></i> {/* Font Awesome icon */}
        Congratulations, your code looks squeaky clean, and no vulnerabilities were found. You get a seal of approval.
      </div>
    );
  }

  return (
    <div>
      {vulnerabilities.map((vuln, index) => (
        <Card key={index} className="vulnerability-card">
          <Card.Header>
            <div className="header-content">
              {vuln.cwe.cwe_name}
              <span className="cwe-id">{vuln.cwe.cwe_id}</span>
            </div>
          </Card.Header>
          <Card.Body>
            <div>
              <CodeBlockSnippet codeString={vuln.code_extract} language={language} />
              <div className="vuln-summary-custom">{vuln.vuln_summary}</div>
            </div>
          </Card.Body>
        </Card>
      ))}
    </div>
  );
}

export default VulnerabilityCards;